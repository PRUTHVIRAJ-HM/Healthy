{% extends 'base.html' %}

{% block content %}
<div class="container">
    <div class="row align-items-center">
        <div class="col-lg-6 mb-5 mb-lg-0">
            <h1 class="mb-4">Check Your Food Safety</h1>
            <p class="lead mb-4">Upload your prescription and enter a food item to check if it's safe for your health conditions.</p>
            
            <div class="card border-0 shadow-sm">
                <div class="card-body p-4">
                    <form method="POST" action="/analyze" enctype="multipart/form-data" id="food-safety-form">
                        <div class="mb-4">
                            <label for="food_name" class="form-label">Food item to check</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-utensils"></i></span>
                                <input type="text" class="form-control" id="food_name" name="food_name" placeholder="e.g., Grapefruit, Spinach, Coffee" required>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label for="prescription" class="form-label">Upload your prescription</label>
                            <div class="input-group">
                                <span class="input-group-text"><i class="fas fa-file-medical"></i></span>
                                <input type="file" class="form-control" id="prescription" name="prescription" accept=".pdf,.jpg,.jpeg,.png" required>
                            </div>
                            <div class="form-text text-muted">We accept PDF and image files (JPG, PNG). Your prescription is analyzed privately and never stored.</div>
                        </div>
                        
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary btn-lg" id="analyze-btn">
                                <i class="fas fa-microscope me-2"></i> Analyze Food Safety
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <div class="col-lg-6">
            <div class="position-relative">
                <div class="decorative-shape shape-1" style="background-color: var(--accent-color-3);"></div>
                <img src="https://images.unsplash.com/photo-1505253758473-96b7015fcd40" alt="Food and Health" class="img-fluid rounded-4 shadow">
                <div class="decorative-shape shape-2" style="background-color: var(--accent-color-1);"></div>
            </div>
        </div>
    </div>

    <!-- How It Works Section -->
    <div class="mt-5 pt-5">
        <h2 class="section-heading">How It Works</h2>
        
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card h-100 border-0">
                    <div class="card-body text-center p-4">
                        <div class="rounded-circle bg-primary bg-opacity-10 d-inline-flex align-items-center justify-content-center mb-4" style="width: 80px; height: 80px;">
                            <i class="fas fa-clipboard-list fa-2x text-primary"></i>
                        </div>
                        <h5 class="card-title">Step 1: Upload</h5>
                        <p class="card-text text-muted">Upload your prescription and enter the food you want to check.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0">
                    <div class="card-body text-center p-4">
                        <div class="rounded-circle bg-primary bg-opacity-10 d-inline-flex align-items-center justify-content-center mb-4" style="width: 80px; height: 80px;">
                            <i class="fas fa-robot fa-2x text-primary"></i>
                        </div>
                        <h5 class="card-title">Step 2: Analysis</h5>
                        <p class="card-text text-muted">Our system analyzes your prescription for any dietary restrictions.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0">
                    <div class="card-body text-center p-4">
                        <div class="rounded-circle bg-primary bg-opacity-10 d-inline-flex align-items-center justify-content-center mb-4" style="width: 80px; height: 80px;">
                            <i class="fas fa-check-circle fa-2x text-primary"></i>
                        </div>
                        <h5 class="card-title">Step 3: Results</h5>
                        <p class="card-text text-muted">Get a clear recommendation on whether the food is safe for you.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Food Safety Info -->
    <div class="row my-5 pt-3">
        <div class="col-md-6">
            <div class="card h-100 border-0">
                <div class="card-body p-4">
                    <h3 class="card-title mb-3">Food Safety Matters</h3>
                    <p class="card-text text-muted">
                        Food safety is critical, especially when you're on medication. Some foods can interact with your 
                        medications, reducing their effectiveness or causing adverse reactions.
                    </p>
                    <p class="card-text text-muted">
                        Our tool helps you make informed decisions about what foods are safe to eat based on your 
                        prescription and health conditions.
                    </p>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card h-100 border-0">
                <div class="card-body p-4">
                    <h3 class="card-title mb-3">Powered by AI</h3>
                    <p class="card-text text-muted">
                        We use advanced AI techniques including:
                    </p>
                    <ul class="text-muted">
                        <li>Text extraction from prescriptions</li>
                        <li>RAG (Retrieval-Augmented Generation) for food safety knowledge</li>
                        <li>Web scraping to get up-to-date food information</li>
                        <li>Natural language processing to understand restrictions</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Featured Foods -->
    <div class="mt-5 pt-3">
        <h2 class="section-heading">Featured Foods</h2>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card h-100 border-0">
                    <img src="https://images.unsplash.com/photo-1577234286642-fc512a5f8f11" class="card-img-top rounded-4" alt="Citrus Fruits">
                    <div class="card-body">
                        <h5 class="card-title">Citrus Fruits</h5>
                        <p class="card-text text-muted">High in vitamin C, but grapefruit can interact with many medications.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0">
                    <img src="https://images.unsplash.com/photo-1607532941433-304659e8198a" class="card-img-top rounded-4" alt="Fresh Salads">
                    <div class="card-body">
                        <h5 class="card-title">Fresh Salads</h5>
                        <p class="card-text text-muted">Rich in vitamins and minerals, but may interact with blood thinners like warfarin.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card h-100 border-0">
                    <img src="https://images.unsplash.com/photo-1519708227418-c8fd9a32b7a2" class="card-img-top rounded-4" alt="Seafood">
                    <div class="card-body">
                        <h5 class="card-title">Seafood</h5>
                        <p class="card-text text-muted">Great source of omega-3, but may cause allergic reactions in some individuals.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Disclaimer -->
    <div class="my-5">
        <div class="card border-0 bg-light rounded-4">
            <div class="card-body p-4">
                <div class="row align-items-center">
                    <div class="col-md-3 text-center">
                        <img src="https://images.unsplash.com/photo-1585435557343-3b092031a831" alt="Medical Disclaimer" class="img-fluid rounded-4" style="max-height: 180px;">
                    </div>
                    <div class="col-md-9">
                        <h3 class="card-title mb-3">Disclaimer</h3>
                        <p class="card-text text-muted">
                            This tool is designed as an informational resource only and should not replace professional medical advice. 
                            Always consult with your healthcare provider or pharmacist about potential food-drug interactions.
                        </p>
                        <p class="card-text text-muted">
                            Results are based on general knowledge and may not account for all possible interactions or individual factors.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Form submission - show loading state
    document.getElementById('food-safety-form').addEventListener('submit', function(e) {
        const button = document.getElementById('analyze-btn');
        button.innerHTML = '<span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span> Analyzing...';
        button.disabled = true;
    });
</script>
{% endblock %}